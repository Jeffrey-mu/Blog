(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{501:function(t,s,e){"use strict";e.r(s);var a=e(13),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"【puppeteer】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#【puppeteer】"}},[t._v("#")]),t._v(" 【Puppeteer】")]),t._v(" "),e("h2",{attrs:{id:"puppeteer概要】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer概要】"}},[t._v("#")]),t._v(" Puppeteer概要】")]),t._v(" "),e("ul",[e("li",[t._v("Puppeteer 是一个 Node 库，它提供了一个高级 API 来通过 DevTools 协议控制 Chromium 或 Chrome。 Puppeteer API 是分层次的，反映了浏览器结构。")]),t._v(" "),e("li",[t._v("Puppeteer 使用 DevTools 协议 与浏览器进行通信。")]),t._v(" "),e("li",[t._v("Browser 实例可以拥有浏览器上下文。")]),t._v(" "),e("li",[t._v("BrowserContext 实例定义了一个浏览会话并可拥有多个页面。")]),t._v(" "),e("li",[t._v("Page 至少有一个框架：主框架。 可能还有其他框架由 iframe 或 框架标签 创建。")]),t._v(" "),e("li",[t._v("frame 至少有一个执行上下文 - 默认的执行上下文 - 框架的 JavaScript 被执行。 一个框架可能有额外的与 扩展 关联的执行上下文。")]),t._v(" "),e("li",[t._v("Worker 具有单一执行上下文，并且便于与 WebWorkers 进行交互。")])]),t._v(" "),e("h2",{attrs:{id:"【puppeteer-错误处理】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#【puppeteer-错误处理】"}},[t._v("#")]),t._v(" 【Puppeteer 错误处理】")]),t._v(" "),e("p",[e("code",[t._v("Error handling")])]),t._v(" "),e("ul",[e("li",[t._v("如果 "),e("code",[t._v("Puppeteer")]),t._v(" 方法无法执行一个请求，就会抛出一个错误。例如，"),e("code",[t._v("page.waitForSelector(selector[, options])")]),t._v("选择器如果在给定的时间范围内无法匹配节点，就会失败。 对于某些类型的错误，"),e("code",[t._v("Puppeteer")]),t._v(" 使用特定的错误类处理。这些类可以通过 "),e("code",[t._v("require('puppeteer/Errors')")]),t._v(" 获得。 支持的类列表：")])]),t._v(" "),e("p",[e("code",[t._v("TimeoutError")]),t._v("\n一个处理超时错误的例子：")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    TimeoutError\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer/Errors'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitForSelector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.foo'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeoutError")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果超时，做一些处理。 ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("h2",{attrs:{id:"puppeteer-working-with-chrome-extensions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-working-with-chrome-extensions"}},[t._v("#")]),t._v(" Puppeteer Working with Chrome Extensions")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Puppeteer")]),t._v(" 可以用来测试 "),e("code",[t._v("Chrome")]),t._v(" 扩展")])]),t._v(" "),e("blockquote",[e("p",[t._v("注意 "),e("code",[t._v("Chrome / Chromium")]),t._v(" 扩展当前只能在非无头模式下使用。")])]),t._v(" "),e("p",[t._v("下面的代码用来处理扩展的"),e("code",[t._v("background page")]),t._v("，该扩展的代码在 "),e("code",[t._v("./my-extension")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pathToExtension "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-extension'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" puppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headless")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("args")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("--disable - extensions - except = $ {\n        pathToExtension\n    }")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("--load - extension = $ {\n        pathToExtension\n    }")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" targets "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("targets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" backgroundPageTarget "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'background_page'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" backgroundPage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" backgroundPageTarget"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("page")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 像处理任何其他页面一样测试背景页面。  await browser.close();})();")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("h2",{attrs:{id:"【puppeteer-class-puppeteer】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#【puppeteer-class-puppeteer】"}},[t._v("#")]),t._v(" 【Puppeteer class:puppeteer】")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Puppeteer")]),t._v(" 模块提供了一种启动 "),e("code",[t._v("Chromium")]),t._v(" 实例的方法。 下面就是使用 "),e("code",[t._v("Puppeteer")]),t._v(" 进行自动化的一个典型示例：")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npuppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" page "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("newPage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://www.google.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 其他操作...  await browser.close();});")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("h3",{attrs:{id:"methods"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#methods"}},[t._v("#")]),t._v(" Methods")]),t._v(" "),e("ul",[e("li",[t._v("puppeteer.connect(options)v0.9.0")]),t._v(" "),e("li",[t._v("puppeteer.createBrowserFetcher([options])v0.9.0")]),t._v(" "),e("li",[t._v("puppeteer.defaultArgs([options])v0.9.0")]),t._v(" "),e("li",[t._v("puppeteer.executablePath()v0.9.0")]),t._v(" "),e("li",[t._v("puppeteer.launch([options])v0.9.0")])]),t._v(" "),e("h3",{attrs:{id:"methods-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#methods-2"}},[t._v("#")]),t._v(" Methods")]),t._v(" "),e("h4",{attrs:{id:"puppeteer-connect-options-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-connect-options-v0-9-0"}},[t._v("#")]),t._v(" puppeteer.connect(options)v0.9.0")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("options")]),t._v(" "),e("code",[t._v("<Object>")])]),t._v(" "),e("li",[e("code",[t._v("browserWSEndpoint")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 一个 浏览器 websocket 端点链接。")]),t._v(" "),e("li",[e("code",[t._v("ignoreHTTPSErrors")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否在导航期间忽略 HTTPS 错误. 默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("defaultViewport")]),t._v(" <?Object> 为每个页面设置一个默认视口大小。默认是 "),e("code",[t._v("800x600")]),t._v("。如果为 null 的话就禁用视图口。")]),t._v(" "),e("li",[e("code",[t._v("width")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 页面宽度像素。")]),t._v(" "),e("li",[e("code",[t._v("height")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 页面高度像素。")]),t._v(" "),e("li",[e("code",[t._v("deviceScaleFactor")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 设置设备的缩放（可以认为是 dpr）。默认是 "),e("code",[t._v("1。")])]),t._v(" "),e("li",[e("code",[t._v("isMobile")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否在页面中设置了"),e("code",[t._v("meta viewport")]),t._v(" 标签。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("hasTouch``<boolean>")]),t._v(" 指定viewport是否支持触摸事件。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("isLandscape")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 指定视口是否处于横向模式。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("slowMo")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 将 Puppeteer 操作减少指定的毫秒数。这样你就可以看清发生了什么，这很有用。")]),t._v(" "),e("li",[e("code",[t._v("returns")]),t._v(": "),e("code",[t._v("<Promise<Browser>>")]),t._v(" 此方法将 "),e("code",[t._v("Puppeteer")]),t._v(" 添加到已有的 "),e("code",[t._v("Chromium")]),t._v(" 实例。")])]),t._v(" "),e("h4",{attrs:{id:"puppeteer-createbrowserfetcher-options-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-createbrowserfetcher-options-v0-9-0"}},[t._v("#")]),t._v(" puppeteer.createBrowserFetcher([options])v0.9.0")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("options")]),t._v(" "),e("code",[t._v("<Object>")])]),t._v(" "),e("li",[e("code",[t._v("host")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 要使用的下载主机. 默认是 "),e("code",[t._v("https://storage.googleapis.com。")])]),t._v(" "),e("li",[e("code",[t._v("path")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 下载文件夹的路径. 默认是 "),e("code",[t._v("<root>")]),t._v("/.local-chromium, "),e("code",[t._v("<root>")]),t._v(" 是 puppeteer 的包根目录。")]),t._v(" "),e("li",[e("code",[t._v("platform")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 可能的值有: "),e("code",[t._v("mac, win32, win64, linux")]),t._v("。默认是"),e("code",[t._v("当前平台")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("returns")]),t._v(": "),e("code",[t._v("<BrowserFetcher>")])])]),t._v(" "),e("h4",{attrs:{id:"puppeteer-defaultargs-options-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-defaultargs-options-v0-9-0"}},[t._v("#")]),t._v(" puppeteer.defaultArgs([options])v0.9.0")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("options")]),t._v(" "),e("code",[t._v("<Object>")]),t._v(" 设置浏览器可选项。有一下字段：")]),t._v(" "),e("li",[e("code",[t._v("headless")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否在 无头模式 下运行浏览器。默认是 "),e("code",[t._v("true")]),t._v(" 除非 "),e("code",[t._v("devtools")]),t._v(" 选项是 "),e("code",[t._v("true。")])]),t._v(" "),e("li",[e("code",[t._v("args")]),t._v(" "),e("code",[t._v("<Array<string>>")]),t._v(" 传递给浏览器实例的其他参数。可以 在这 找到 Chromium 标志列表。")]),t._v(" "),e("li",[e("code",[t._v("userDataDir")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 用户数据目录 的路径。")]),t._v(" "),e("li",[e("code",[t._v("devtools")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否为每个选项卡自动打开 "),e("code",[t._v("DevTools")]),t._v(" 面板。如果这个选项是 "),e("code",[t._v("true")]),t._v(" 的话, "),e("code",[t._v("headless")]),t._v(" 选项将被设置为 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("returns")]),t._v(": "),e("code",[t._v("<Array<string>>")]),t._v(" Chromium 启动时使用的默认参数。")])]),t._v(" "),e("h4",{attrs:{id:"puppeteer-executablepath-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-executablepath-v0-9-0"}},[t._v("#")]),t._v(" puppeteer.executablePath()v0.9.0")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("returns")]),t._v(": "),e("code",[t._v("<string>")]),t._v(" Puppeteer 希望找到绑定的 "),e("code",[t._v("Chromium")]),t._v(" 的路径。")]),t._v(" "),e("li",[t._v("如果使用 "),e("code",[t._v("PUPPETEER_SKIP_CHROMIUM_DOWNLOAD")]),t._v("跳过下载，则 "),e("code",[t._v("Chromium")]),t._v(" 可能不存在。")])]),t._v(" "),e("h4",{attrs:{id:"puppeteer-launch-options-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-launch-options-v0-9-0"}},[t._v("#")]),t._v(" puppeteer.launch([options])v0.9.0")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("options")]),t._v(" <"),e("code",[t._v("Object>")]),t._v(" 在浏览器上设置的一组可配置选项。 有以下字段：")]),t._v(" "),e("li",[e("code",[t._v("ignoreHTTPSErrors")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否在导航期间忽略 "),e("code",[t._v("HTTPS")]),t._v(" 错误. 默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("headless")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否以 无头模式 运行浏览器。默认是 "),e("code",[t._v("true，除非")]),t._v(" "),e("code",[t._v("devtools")]),t._v(" 选项是 "),e("code",[t._v("true。")])]),t._v(" "),e("li",[e("code",[t._v("executablePath")]),t._v(" "),e("code",[t._v("<string>")]),t._v(" 可运行 Chromium 或 Chrome 可执行文件的路径，而不是绑定的 "),e("code",[t._v("Chromium。如果")]),t._v(" "),e("code",[t._v("executablePath")]),t._v(" 是一个相对路径，那么他相对于 当前工作路径 解析。")]),t._v(" "),e("li",[e("code",[t._v("slowMo")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 将 Puppeteer 操作减少指定的毫秒数。这样你就可以看清发生了什么，这很有用。")]),t._v(" "),e("li",[e("code",[t._v("defaultViewport")]),t._v(" "),e("code",[t._v("<?Object>")]),t._v(" 为每个页面设置一个默认视口大小。默认是 "),e("code",[t._v("800x600")]),t._v("。如果为 null 的话就禁用视图口。")]),t._v(" "),e("li",[e("code",[t._v("width")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 页面宽度像素。")]),t._v(" "),e("li",[e("code",[t._v("height")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 页面高度像素。")]),t._v(" "),e("li",[e("code",[t._v("deviceScaleFactor")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 设置设备的缩放（可以认为是 "),e("code",[t._v("dpr")]),t._v("）。默认是 "),e("code",[t._v("1")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("isMobile")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否在页面中设置了 "),e("code",[t._v("meta viewport")]),t._v(" 标签。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("hasTouch``<boolean>")]),t._v(" 指定viewport是否支持触摸事件。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("isLandscape")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 指定视口是否处于横向模式。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("args")]),t._v(" "),e("code",[t._v("<Array<string>>")]),t._v(" 传递给浏览器实例的其他参数。 这些参数可以参考 这里。")]),t._v(" "),e("li",[t._v("ignoreDefaultArgs <(boolean|"),e("code",[t._v("<Array<string>>")]),t._v(")> 如果是 "),e("code",[t._v("true")]),t._v("，那就不要使用 "),e("code",[t._v("puppeteer.defaultArgs()")]),t._v("。 如果给出了数组，则过滤掉给定的默认参数。这个选项请谨慎使用。默认为 "),e("code",[t._v("false")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("handleSIGINT")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" Ctrl-C 关闭浏览器进程。默认是 "),e("code",[t._v("true")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("handleSIGTERM")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 关闭 SIGTERM 上的浏览器进程。默认是 "),e("code",[t._v("true")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("handleSIGHUP")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 关闭 SIGHUP 上的浏览器进程。默认是 "),e("code",[t._v("true")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("timeout")]),t._v(" "),e("code",[t._v("<number>")]),t._v(" 等待浏览器实例启动的最长时间（以毫秒为单位）。默认是 "),e("code",[t._v("30000 (30 秒)")]),t._v(". 通过 0 来禁用超时。")]),t._v(" "),e("li",[e("code",[t._v("dumpio")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否将浏览器进程标准输出和标准错误输入到 "),e("code",[t._v("process.stdout 和 process.stderr")]),t._v(" 中。默认是 "),e("code",[t._v("false。")])]),t._v(" "),e("li",[e("code",[t._v("userDataDir")]),t._v(" <"),e("code",[t._v("string>")]),t._v(" 用户数据目录 路径。")]),t._v(" "),e("li",[e("code",[t._v("env")]),t._v(" "),e("code",[t._v("<Object>")]),t._v(" 指定浏览器可见的环境变量。默认是"),e("code",[t._v("process.env")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("devtools")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 是否为每个选项卡自动打开DevTools面板。如果这个选项是 "),e("code",[t._v("true，headless")]),t._v(" 选项将会设置成 "),e("code",[t._v("false")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("pipe")]),t._v(" "),e("code",[t._v("<boolean>")]),t._v(" 通过管道而不是WebSocket连接到浏览器。默认是 "),e("code",[t._v("false")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("returns")]),t._v(": "),e("code",[t._v("<Promise<Browser>>")]),t._v(" 浏览器实例支持 "),e("code",[t._v("Promise")]),t._v("。\n这个方法结合了下面3个步骤：")])]),t._v(" "),e("h4",{attrs:{id:"使用-puppeteer-defaultargs-作为一组默认值来启动-chromium。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-puppeteer-defaultargs-作为一组默认值来启动-chromium。"}},[t._v("#")]),t._v(" 使用 puppeteer.defaultArgs() 作为一组默认值来启动 Chromium。")]),t._v(" "),e("p",[t._v("启动浏览器并根据 "),e("code",[t._v("executablePath")]),t._v(" ，"),e("code",[t._v("handleSIGINT")]),t._v("，"),e("code",[t._v("dumpio")]),t._v(" 和其他选项开始管理它的进程。\n创建一个 "),e("code",[t._v("Browser")]),t._v(" 类的实例，并根据 "),e("code",[t._v("defaultViewport")]),t._v("，"),e("code",[t._v("slowMo")]),t._v(" 和 "),e("code",[t._v("ignoreHTTPSErrors")]),t._v(" 初始化它。\n"),e("code",[t._v("ignoreDefaultArgs")]),t._v(" 选项可用于自定义（1）步骤的行为。 例如，要从参数中过滤掉 "),e("code",[t._v("--mute-audio")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" puppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ignoreDefaultArgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'--mute-audio'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h2",{attrs:{id:"puppeteer-浏览器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-浏览器"}},[t._v("#")]),t._v(" Puppeteer 浏览器")]),t._v(" "),e("ul",[e("li",[t._v("extends: "),e("code",[t._v("EventEmitter")]),t._v(" 当 "),e("code",[t._v("Puppeteer")]),t._v(" 连接到一个 "),e("code",[t._v("Chromium")]),t._v(" 实例的时候会通过 "),e("code",[t._v("puppeteer.launch")]),t._v(" 或 "),e("code",[t._v("puppeteer.connect")]),t._v(" 创建一个 "),e("code",[t._v("Browser")]),t._v(" 对象。 下面是使用 "),e("code",[t._v("Browser")]),t._v(" 创建 "),e("code",[t._v("Page")]),t._v(" 的例子")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npuppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" page "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("newPage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("ul",[e("li",[t._v("一个断开连接和重连到 Browser 的例子：")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npuppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 存储节点以便能重新连接到 Chromium  ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" browserWSEndpoint "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wsEndpoint")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 Chromium 断开和 puppeteer 的连接  browser.disconnect();  // 使用节点来重新建立连接  ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" browser2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" puppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("browserWSEndpoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭 Chromium  ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("h2",{attrs:{id:"puppeteer-页面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppeteer-页面"}},[t._v("#")]),t._v(" Puppeteer 页面")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Page")]),t._v(" 提供操作一个 "),e("code",[t._v("tab")]),t._v(" 页或者 "),e("code",[t._v("extension")]),t._v(" "),e("code",[t._v("background")]),t._v(" "),e("code",[t._v("page")]),t._v(" 的方法。一个 "),e("code",[t._v("Browser")]),t._v(" 实例可以有多个 "),e("code",[t._v("Page")]),t._v(" 实例。 下面的例子创建一个 "),e("code",[t._v("Page")]),t._v(" 实例，导航到一个 "),e("code",[t._v("url")]),t._v(" ，然后保存截图：")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npuppeteer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" browser "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" page "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("newPage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("screenshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'screenshot.png'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("ul",[e("li",[t._v("Page会触发多种事件（下面描述的），可以用 node原生的方法 来捕获处理，比如 "),e("code",[t._v("on")]),t._v(","),e("code",[t._v("once")]),t._v(" 或者 "),e("code",[t._v("removeListener。")]),t._v(" 下面的例子捕获了一个 "),e("code",[t._v("page")]),t._v(" 实例的 "),e("code",[t._v("load")]),t._v(" 事件，打印了一句话：")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("once")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Page loaded!'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ul",[e("li",[t._v("可以用 "),e("code",[t._v("removeListener")]),t._v(" 取消对事件的监听：")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("logRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("interceptedRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A request was made:'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" interceptedRequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\npage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" logRequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一段时间后...page.removeListener('request', logRequest);")]),t._v("\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("h3",{attrs:{id:"methods-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#methods-3"}},[t._v("#")]),t._v(" Methods")]),t._v(" "),e("h4",{attrs:{id:"page-selector-v0-9-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#page-selector-v0-9-0"}},[t._v("#")]),t._v(" page.$(selector)v0.9.0")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("selector "),e("code",[t._v("<string>")]),t._v(" 选择器 返回: "),e("code",[t._v("<Promise<?ElementHandle>>")])])]),t._v(" "),e("li",[e("p",[t._v("此方法在页面内执行 "),e("code",[t._v("document.querySelector")]),t._v("。如果没有元素匹配指定选择器，返回值是 null。")])]),t._v(" "),e("li",[e("p",[t._v("page.mainFrame().$(selector) 的简写。")])])]),t._v(" "),e("h4",{attrs:{id:"page-selector-v0-9-0-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#page-selector-v0-9-0-2"}},[t._v("#")]),t._v(" page.$$(selector)v0.9.0")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("selector "),e("code",[t._v("<string>")]),t._v(" 选择器 返回: "),e("code",[t._v("<Promise<Array<ElementHandle>>>")])])]),t._v(" "),e("li",[e("p",[t._v("此方法在页面内执行 "),e("code",[t._v("document.querySelector")]),t._v("。如果没有元素匹配指定选择器，返回值是 null。 page.mainFrame().$(selector) 的简写。")])])]),t._v(" "),e("h4",{attrs:{id:"page-selector-v0-9-0-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#page-selector-v0-9-0-3"}},[t._v("#")]),t._v(" page.$$(selector)v0.9.0")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("selector "),e("code",[t._v("<string>")]),t._v(" 选择器")])]),t._v(" "),e("li",[e("p",[t._v("返回: "),e("code",[t._v("<Promise<Array<ElementHandle>>>")])])]),t._v(" "),e("li",[e("p",[t._v("此方法在页面内执行 "),e("code",[t._v("document.querySelectorAll")]),t._v("。如果没有元素匹配指定选择器，返回值是 []。")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("page.mainFrame().$$(selector)")]),t._v("的简写。")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);